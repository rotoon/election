# เอกสารความต้องการของระบบ (PRD) - ระบบเลือกตั้งออนไลน์

## 1. บทนำ (Introduction)

ระบบเลือกตั้งออนไลน์ (Online Election System) ถูกพัฒนาขึ้นเพื่อจำลองการเลือกตั้งแบบดิจิทัล โดยมุ่งเน้นความโปร่งใส ใช้งานง่าย และรองรับการทำงานของผู้ใช้งาน 3 กลุ่มหลัก ได้แก่ ผู้ดูแลระบบ (Admin), กกต. (Election Commission), และผู้ใช้สิทธิเลือกตั้ง (Voter) ระบบครอบคลุมตั้งแต่การลงทะเบียน การจัดการเขตเลือกตั้ง พรรคการเมือง ผู้สมัคร การลงคะแนน ไปจนถึงการประกาศผลคะแนนแบบ Real-time

## 2. สิทธิ์และการใช้งาน (User Roles & Capabilities)

### 2.1 ผู้ดูแลระบบ (Admin)

**หน้าที่หลัก**: ดูแลระบบและจัดการข้อมูลพื้นฐาน

- **การจัดการเขตเลือกตั้ง**: สร้าง, แก้ไข, ลบ ข้อมูลจังหวัดและเขตเลือกตั้ง
- **การจัดการผู้ใช้**: เปลี่ยนสถานะผู้ใช้งานทั่วไปเป็น "กกต." (EC) ได้
- **สิทธิ์การเลือกตั้ง**: **ไม่มีสิทธิ์ลงคะแนน** (สงวนสิทธิ์เฉพาะ Voter และ EC ที่ลงทะเบียนด้วยข้อมูลจริงเท่านั้น)

### 2.2 คณะกรรมการการเลือกตั้ง (กกต. / EC)

**หน้าที่หลัก**: จัดการข้อมูลการเลือกตั้งและควบคุมสถานะหีบ

- **การจัดการพรรคการเมือง**: สร้างพรรค, แก้ไขข้อมูลพรรค, อัปโหลดโลโก้
- **การจัดการผู้สมัคร**: เพิ่ม/แก้ไขผู้สมัครในแต่ละเขต, ผูกผู้สมัครกับพรรค
- **การควบคุมการเลือกตั้ง**: สั่ง "ปิดหีบ" รายเขตเลือกตั้ง (เมื่อปิดแล้วจะนับคะแนนทันที)
- **สิทธิ์การใช้งานในฐานะ Voter**: สามารถทำทุกอย่างได้เหมือนผู้ใช้สิทธิเลือกตั้ง (ลงคะแนน, เปลี่ยนคะแนน, ดูผลการเลือกตั้ง)

### 2.3 ผู้ใช้สิทธิเลือกตั้ง (Voter)

**หน้าที่หลัก**: ประชาชนทั่วไปและผู้ใช้งานทุกคนในระบบ

- **การลงทะเบียน**: สมัครสมาชิกด้วยข้อมูลบัตรประชาชนและที่อยู่
- **การลงคะแนน**: เลือกผู้สมัครในเขตของตนเอง (1 คน)
- **การแก้ไขคะแนน**: เปลี่ยนใจได้ไม่จำกัดจำนวนครั้ง _ก่อนเวลาปิดหีบ_
- **การดูผล**: ดูรายชื่อผู้สมัคร (ก่อนปิดหีบ) และดูคะแนน/ผู้ชนะ (หลังปิดหีบ)

## 3. ความต้องการของระบบ (Functional Requirements)

### 3.1 ระบบลงทะเบียนและยืนยันตัวตน (Registration & Identity)

- **การลงทะเบียน**: ผู้ใช้งานทุกคนต้องลงทะเบียนก่อนเข้าใช้งาน โดยระบุข้อมูลดังนี้:
  - ชื่อ-นามสกุล
  - หมายเลขประจำตัวประชาชน (13 หลัก)
  - ที่อยู่
  - เขตเลือกตั้ง (ระบุ จังหวัด - เขตการเลือกตั้งที่ ...) ซึ่งระบบเตรียมข้อมูลไว้ให้เลือก
- **สถานะเริ่มต้น**: เมื่อลงทะเบียนสำเร็จ สถานะเริ่มต้นจะเป็น "ผู้ใช้สิทธิเลือกตั้ง" (Voter)
- **การปรับเปลี่ยนสถานะ**: ผู้ดูแลระบบ (Admin) สามารถเปลี่ยนสถานะผู้ใช้งานจาก "ผู้ใช้สิทธิเลือกตั้ง" เป็น "กกต." ได้

### 3.2 การจัดการเขตเลือกตั้ง (Constituency Management)

- **ผู้รับผิดชอบ**: ผู้ดูแลระบบ (Admin)
- **ฟังก์ชัน**:
  - กำหนดรายชื่อจังหวัดและเขตการเลือกตั้งในระบบ (เช่น กรุงเทพมหานคร เขต 1, เชียงใหม่ เขต 1)
  - แก้ไขรายละเอียดเขตเลือกตั้ง

### 3.3 การจัดการพรรคการเมืองและผู้สมัคร (Party & Candidate Management)

- **ผู้รับผิดชอบ**: กกต. (EC)
- **การจัดการพรรคการเมือง**:
  - สร้างพรรคการเมืองใหม่ โดยระบุ ชื่อพรรค, รูปโลโก้พรรค, และนโยบายพรรค
  - แก้ไข/ดูข้อมูลพรรคการเมือง
- **การจัดการผู้สมัคร**:
  - เพิ่มผู้สมัครในแต่ละเขตเลือกตั้ง
  - นำเข้าข้อมูล: รูปภาพผู้สมัคร, หมายเลขผู้สมัคร, ชื่อ-นามสกุล, พรรคการเมืองที่สังกัด, และนโยบายส่วนตัว
  - **เงื่อนไข**: ผู้สมัครทุกคนต้องสังกัดพรรคการเมืองที่มีอยู่ในระบบเท่านั้น

### 3.4 การจัดการการเลือกตั้ง (Election Control)

- **ผู้รับผิดชอบ**: กกต. (EC)
- **ฟังก์ชัน**:
  - **เปิด/ปิดหีบเลือกตั้ง**: กกต. สามารถสั่ง "ปิดหีบเลือกตั้ง" ได้รายเขต
  - **ผลกระทบ**: เมื่อปิดหีบเลือกตั้งแล้ว ผลคะแนนในเขตนั้นจะถือเป็นที่สิ้นสุดและไม่สามารถแก้ไขได้

### 3.5 การลงคะแนนเสียง (Voting Process)

- **ผู้รับผิดชอบ**: ผู้ใช้สิทธิเลือกตั้ง (Voter)
- **เงื่อนไข**:
  - ผู้ใช้จะเห็นเฉพาะผู้สมัครในเขตเลือกตั้งที่ตนลงทะเบียนไว้
  - สามารถเลือกผู้สมัครได้เพียง 1 ท่าน
- **การแก้ไขคะแนน**:
  - สามารถเปลี่ยนแปลงการลงคะแนนได้ไม่จำกัดจำนวนครั้ง **ตราบใดที่หีบเลือกตั้งของเขตนั้นยังไม่ถูกปิด**
  - เมื่อหีบปิดแล้ว จะไม่สามารถแก้ไขคะแนนได้อีก

### 3.6 การแสดงผลและรายงาน (Dashboard & Results)

- **ผู้เข้าชม**: บุคคลทั่วไป (Public Users)
- **การแสดงผลรายเขต**:
  - เลือกดูข้อมูลตามเขตการเลือกตั้งได้
  - **สถานะยังไม่ปิดหีบ**: แสดงรายชื่อผู้สมัคร แต่ **ไม่แสดงคะแนน**
  - **สถานะปิดหีบแล้ว**: แสดงรายชื่อผู้สมัคร พร้อม **คะแนนที่ได้**
- **ภาพรวมพรรคการเมือง**:
  - แสดงข้อมูลทุกพรรคการเมืองและนโยบาย (สามารถกดเข้าไปดูรายละเอียดได้)
  - แสดงจำนวนผู้สมัครที่ได้รับการเลือกตั้ง (ส.ส.) ของแต่ละพรรค (นับเฉพาะจากเขตที่ปิดหีบแล้ว)

## 4. เทคโนโลยีที่ใช้ (Tech Stack)

อ้างอิงจากมาตรฐาน Toh Framework:

- **Architecture**: แยกส่วน Frontend และ Backend ชัดเจน (Separated Frontend & Backend)
- **Frontend**: Next.js 14 (App Router), Tailwind CSS, shadcn/ui
- **State Management**: Zustand
- **Backend API**: Node.js / Custom Server (Prisma ORM)
- **Database**: Supabase (PostgreSQL)
- **Language**: TypeScript throughout
- **Testing**: Playwright (E2E), Jest (Unit)

## 5. หมายเหตุเพิ่มเติม

- ระบบต้องรองรับการทำงานบนรูปแบบ Web Application
- การออกแบบ UI/UX เน้นความเป็นมิตรและเข้าใจง่าย สำหรับผู้ใช้งานทุกระดับ
